<?xml version="1.0"?>
<project>
	<parent>
    <groupId>exo-portlet-container</groupId>
    <artifactId>exo-portlet-container</artifactId>
    <version>1.5</version>
	</parent>	
  <modelVersion>4.0.0</modelVersion>
  <artifactId>exo-portlet-container.services.wsrp.api</artifactId>
  <packaging>jar</packaging>
  <name>eXo wsrp service API</name>
  <url>http://www.exoplatform.org</url>
  <description>eXo WSRP Services API</description>

  <dependencies>
    <dependency>
      <groupId>axis</groupId>
      <artifactId>axis</artifactId>
      <version>1.2-RC1</version>
    </dependency>

    <dependency>
      <groupId>wsdl4j</groupId>
      <artifactId>wsdl4j</artifactId>
      <version>1.4</version>
    </dependency>
    
    <dependency>
      <groupId>soap</groupId>
      <artifactId>soap</artifactId>
      <version>2.3</version>
    </dependency>
    
    <dependency>
      <groupId>commons-logging</groupId>
      <artifactId>commons-logging</artifactId>
      <version>1.0.3</version>
    </dependency>

    <dependency>
      <groupId>commons-discovery</groupId>
      <artifactId>commons-discovery</artifactId>
      <version>0.2</version>
    </dependency>
    
    <dependency>
      <groupId>javax.xml</groupId>
      <artifactId>saaj-api</artifactId>
      <version>1.1</version>
    </dependency>
    
    <dependency>
      <groupId>javax.xml</groupId>
      <artifactId>jaxrpc</artifactId>
      <version>1.1</version>
    </dependency>

    <dependency>
      <groupId>junit</groupId>
      <artifactId>junit</artifactId>
      <version>3.8.1</version>
      <scope>compile</scope>
    </dependency>

    <dependency>
      <groupId>javax.portlet</groupId>
      <artifactId>portlet-api</artifactId>
      <version>1.0</version>
      <scope>compile</scope>
    </dependency>   
  </dependencies>

  <profiles>
    <profile>
      <id>wsrp.api</id>  
      <activation>
        <activeByDefault>true</activeByDefault>
      </activation>
      <properties>
        <src.gen.dir>${basedir}/target/generated</src.gen.dir>
      </properties>
    </profile>
  </profiles>

  <build>
    <resources>
      <resource>
        <directory>target/generated</directory>
        <includes>
          <include>**/*.wsdd</include>
        </includes>
      </resource>
    </resources>
    <plugins>
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <executions>
          <execution>
            <phase>generate-sources</phase>
            <configuration>
              <tasks>
                <mkdir dir="${src.gen.dir}"/>

                <java fork="yes" dir="wsdl" classname="org.apache.axis.wsdl.WSDL2Java">
                  <sysproperty key="proxySet" value=""/>
                  <sysproperty key="proxyHost" value="localhost"/>
                  <sysproperty key="proxyPort" value="80"/>
                  <arg line="-v -t -O -1 --server-side --deployScope 'Application' -W -o ${src.gen.dir} wsrp_service.wsdl"/>
                  <classpath refid="maven.dependency.classpath"/>
                </java>

                <delete file="${src.gen.dir}/org/exoplatform/services/wsrp/bind/WSRP_v1_ServiceDescription_Binding_SOAPImpl.java"/>
                <delete file="${src.gen.dir}/org/exoplatform/services/wsrp/bind/WSRP_v1_Registration_Binding_SOAPImpl.java"/>
                <delete file="${src.gen.dir}/org/exoplatform/services/wsrp/bind/WSRP_v1_Markup_Binding_SOAPImpl.java"/>
                <delete file="${src.gen.dir}/org/exoplatform/services/wsrp/bind/WSRP_v1_PortletManagement_Binding_SOAPImpl.java"/>
              </tasks>
              <sourceRoot>${src.gen.dir}</sourceRoot>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.4</source>
        </configuration>
      </plugin>
    </plugins>
  </build>

</project>
