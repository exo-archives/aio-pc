<?xml version="1.0" encoding="ISO-8859-1"?>

<configuration>
  <component>
    <key>org.exoplatform.services.log.LogConfigurationInitializer</key>
    <type>org.exoplatform.services.log.LogConfigurationInitializer</type>
    <init-params>
      <value-param>
        <name>logger</name>
        <value>org.exoplatform.services.log.impl.BufferedSimpleLog</value>
      </value-param>
      <value-param>
        <name>configurator</name>
        <value>org.exoplatform.services.log.impl.SimpleLogConfigurator</value>
      </value-param>
      <properties-param>
        <name>properties</name>
        <description>SimpleLog properties</description>
        <property name="org.apache.commons.logging.log.org.exoplatform.services.portletcontainer" value="debug"/>
        <property name="org.apache.commons.logging.simplelog.defaultlog" value="info"/>
      </properties-param>
    </init-params>
  </component>
  <component>
  	<key>org.exoplatform.services.cache.CacheService</key>
  	<type>org.exoplatform.services.cache.impl.CacheServiceImpl</type>
  	<init-params>
      <object-param>
        <name>cache.config.default</name>
        <description>The default cache configuration</description>
        <object type="org.exoplatform.services.cache.ExoCacheConfig">
          <field  name="name"><string>default</string></field>
          <field  name="maxSize"><int>100</int></field>
          <field  name="liveTime"><long>300</long></field>
          <field  name="distributed"><boolean>false</boolean></field>
        </object>
      </object-param>
    </init-params>	
  </component>
  <component>
    <key>org.exoplatform.services.log.LogService</key>
    <type>org.exoplatform.services.log.impl.LogServiceImpl</type>
    <!--Valid value: FATAL, ERROR, WARN, INFO, DEBUG, TRACE-->
      <init-params>
		   <properties-param>
		     <name>log.level.config</name>
		     <property name="org.exoplatform.services.log" value="INFO"/>
		   </properties-param>
      </init-params>
  </component>  
	<component>
		<type>org.exoplatform.services.xml.resolving.impl.simple.SimpleDirResolvingServiceImpl</type>
	</component>
  <component>
  	<key>org.exoplatform.services.portletcontainer.PortletContainerService</key>
  	<type>org.exoplatform.services.portletcontainer.impl.PortletContainerServiceImpl</type>
  </component>
  <component>
  	<type>org.exoplatform.services.portletcontainer.impl.PortletContainerDispatcher</type>
  </component>
  <!-- ============================================================================= -->
  <!--    P O R T L E T  C O N T A I N E R    C O N F I G U R A T I O N              -->
  <!-- ============================================================================= -->
  <component>
  	<type>org.exoplatform.services.portletcontainer.impl.PortletApplicationHandler</type>
  </component>
  <component>
  	<key>javax.portlet.PortalContext</key>
  	<type>org.exoplatform.services.portletcontainer.impl.portletAPIImp.PortalContextImp</type>
  </component>
  <component>
  	<key>org.exoplatform.services.portletcontainer.impl.portletAPIImp.persistenceImp.PersistenceManager</key>
  	<type>org.exoplatform.services.portletcontainer.impl.portletAPIImp.persistenceImp.DefaultPersistenceManager</type>
  </component>
  <component>  
  	<type>org.exoplatform.services.portletcontainer.impl.portletAPIImp.bundle.ResourceBundleManager</type>
  </component>  
  <component>
    <type>org.exoplatform.services.portletcontainer.impl.PortletPreferencesPersisterImpl</type>
  </component>  
  <component>
    <type>org.exoplatform.services.portletcontainer.impl.PortletContainerConf</type>
      <init-params>
        <object-param>
          <name>conf</name>
          <object type="org.exoplatform.services.portletcontainer.impl.config.PortletContainer">
            <field name="global">
              <object type="org.exoplatform.services.portletcontainer.impl.config.Global">
                <field name="name"><string>ExoPortletContainer</string></field>
                <field name="description"><string>A JSR 168 compliant portlet container</string></field>
                <field name="majorVersion"><int>1</int></field>
                <field name="minorVersion"><int>0</int></field>
              </object>
            </field>
            <field name="sharedSession">
              <object type="org.exoplatform.services.portletcontainer.impl.config.SharedSession">
                <field name="enable"><string>false</string></field>
              </object>
            </field>
            <field name="bundle">
              <object type="org.exoplatform.services.portletcontainer.impl.config.DelegatedBundle">
                <field name="enable"><string>true</string></field>
              </object>
            </field>
            <!-- field name="objectPool">
              <object type="org.exoplatform.services.portletcontainer.impl.config.ObjectPool">
                <field name="instancesInPool"><int>200</int></field>
              </object>
            </field -->
            <field name="cache">
              <object type="org.exoplatform.services.portletcontainer.impl.config.Cache">
                <field name="enable"><string>true</string></field>
              </object>
            </field>
            <field name="supportedContent">
              <collection type="java.util.ArrayList">
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.SupportedContent">
                    <field name="name"><string>text/html</string></field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.SupportedContent">
                    <field name="name"><string>text/wml</string></field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.SupportedContent">
                    <field name="name"><string>audio/x-mpeg</string></field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.SupportedContent">
                    <field name="name"><string>image/bmp</string></field>
                  </object>
                </value>
              </collection>
            </field>
            <field name="customMode">
              <collection type="java.util.ArrayList">
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomMode">
                    <field name="name"><string>config</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>to let admin config portlets</string></field>
                          </object>
                        </value>
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>fr</string></field>
                            <field name="description"><string>permet de configurer les portlets</string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomMode">
                    <field name="name"><string>wsrp</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>to admin wsrp portlet</string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomMode">
                    <field name="name"><string>monitor</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>to monitor a portlet</string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomMode">
                    <field name="name"><string>about</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>The about portlet mode should be used by the portlet to display information on the portlets purpose, origin, version etc.</string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomMode">
                    <field name="name"><string>edit_defaults</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>
      The edit_defaults portlet mode signifies that the portlet should render a screen to set
      the default values for the modifiable preferences that are typically changed in the EDIT
      screen. Calling this mode requires that the user must have administrator rights. Therefore,
      only the portal can create links for changing the portlet mode into edit_defaults.
                            </string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomMode">
                    <field name="name"><string>print</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>
      The printportlet mode signifies that the portlet should render a view that can be printed.
                            </string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomMode">
                    <field name="name"><string>preview</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>
      The preview portlet mode should be used by the portlet to render output without the need
      of having back-end connections or user specific data available. It may be used at page
      design time and in portlet development tools.
                            </string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
              </collection>
            </field>
            <field name="customWindowState">
              <collection type="java.util.ArrayList">
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomWindowState">
                    <field name="name"><string>half-page</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>portlet takes half of the page</string></field>
                          </object>
                        </value>
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>fr</string></field>
                            <field name="description"><string>portlet sure une demi page</string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.CustomWindowState">
                    <field name="name"><string>max-per-column</string></field>
                    <field name="description">
                      <collection type="java.util.ArrayList">
                        <value>
                          <object type="org.exoplatform.services.portletcontainer.impl.config.Description">
                            <field name="lang"><string>en</string></field>
                            <field name="description"><string>portlet the whole column</string></field>
                          </object>
                        </value>
                      </collection>
                    </field>
                  </object>
                </value>
              </collection>
            </field>
            <field name="properties">
              <collection type="java.util.ArrayList">
                <value>
                  <object type="org.exoplatform.services.portletcontainer.impl.config.Properties">
                    <field name="description"><string>a testing property</string></field>
                    <field name="name"><string>test</string></field>
                    <field name="value"><string>test_value</string></field>
                  </object>
                </value>
              </collection>
            </field>
          </object>
        </object-param>
        <!-- value-param>
          <name>conf-path</name>
          <value>jar:/conf/portal/portlet-container.xml</value>
        </value-param -->
      </init-params>
  </component>

  <component>
    <key>org.exoplatform.services.portletcontainer.impl.PortletApplicationsHolder</key>
    <type>org.exoplatform.services.portletcontainer.impl.PortletApplicationsHolder</type>
  </component>

  <component>
    <key>org.exoplatform.services.portletcontainer.monitor.PortletContainerMonitor</key>
    <jmx-name>monitor:type=PortletContainerMonitor</jmx-name>
    <type>org.exoplatform.services.portletcontainer.impl.monitor.PortletContainerMonitorImpl</type>
  </component>

  <component>
    <key>org.exoplatform.services.portletcontainer.PortletApplicationRegister</key>
    <type>org.exoplatform.services.portletcontainer.impl.PortletApplicationRegisterImpl</type>
  </component>

	<component>
		<type>org.exoplatform.services.xml.transform.impl.html.TidyTransformerServiceImpl</type>
	</component>
	<component>
		<type>org.exoplatform.services.xml.transform.impl.trax.TRAXTransformerServiceImpl</type>
	</component>

  <component>
    <type>org.exoplatform.services.portletcontainer.impl.aop.PortletCommandChain</type>
    <component-plugins>
      <component-plugin>
        <name>portlet.monitor.filter</name>
        <set-method>addCommand</set-method>
        <type>org.exoplatform.services.portletcontainer.impl.aop.PortletMonitorCommand</type>
        <description>this command log  the render  and process action of  each portlet</description>
      </component-plugin>
      <component-plugin>
        <name>portlet.security.filter</name>
        <set-method>addCommand</set-method>
        <type>org.exoplatform.services.portletcontainer.impl.aop.PortletSecurityCommand</type>
        <description>this command check the security  before render  and process action</description>
      </component-plugin>
      <component-plugin>
        <name>portlet.cache.filter</name>
        <set-method>addCommand</set-method>
        <type>org.exoplatform.services.portletcontainer.impl.aop.PortletCacheCommand</type>
        <description>this command retrieve cache in  the render method  and invalidate cache 
          in the process action of  each portlet</description>
      </component-plugin>
      <component-plugin>
        <name>portlet.content.filter</name>
        <set-method>addCommand</set-method>
        <type>org.exoplatform.services.portletcontainer.impl.aop.PortletContentCommand</type>
        <description>this command retrieve cache in  the render method  and invalidate cache 
          in the process action of  each portlet</description>
      </component-plugin>
      <component-plugin>
        <name>portlet.method.filter</name>
        <set-method>addCommand</set-method>
        <type>org.exoplatform.services.portletcontainer.impl.aop.PortletMethodCommand</type>
        <description>this command execute the method process action and render  of the portlet</description>
      </component-plugin>
    </component-plugins>
  </component>
</configuration>