<project>
  <parent>
    <groupId>org.exoplatform.portletcontainer</groupId>
    <artifactId>config</artifactId>
    <version>trunk</version>
  </parent>
  <modelVersion>4.0.0</modelVersion>
  <artifactId>exo.pc.component.plugins.wsrp2</artifactId>
  <packaging>jar</packaging>
  <name>eXo Portlet Container 2 Plugins WSRP2</name>
  <description>eXo Portlet Container 2 wsrp2 plugin</description>

  <repositories>
    <repository>
      <id>maven.org</id>
      <name>maven.org repository</name>
      <url>http://repo1.maven.org/maven2</url>
      <layout>default</layout>
    </repository>
  </repositories>

  <dependencies>

    <dependency>
      <groupId>org.exoplatform.kernel</groupId>
      <artifactId>exo.kernel.commons</artifactId>
      <version>${exo.platform.version}</version>
      <scope>compile</scope>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.kernel</groupId>
      <artifactId>exo.kernel.container</artifactId>
      <version>${exo.platform.version}</version>
      <scope>compile</scope>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.kernel</groupId>
      <artifactId>exo.kernel.component.cache</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.xml-processing</artifactId>
      <version>${exo.platform.version}</version>
      <scope>compile</scope>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.organization.api</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.common</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.database</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.resources.api</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.organization.jdbc</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
       <groupId>org.exoplatform.portletcontainer</groupId>
       <artifactId>exo.pc.component.core</artifactId>
       <version>${exo.portlet-container.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.portletcontainer</groupId>
      <artifactId>exo.pc.component.plugins.pc</artifactId>
      <version>${exo.portlet-container.version}</version>
    </dependency>

    <!-- ************************ soap ************************ -->

    <dependency>
      <groupId>axis</groupId>
      <artifactId>axis</artifactId>
      <version>1.4</version>
    </dependency>
    <dependency>
      <groupId>wsdl4j</groupId>
      <artifactId>wsdl4j</artifactId>
      <version>1.4</version>
    </dependency>
    <dependency>
      <groupId>soap</groupId>
      <artifactId>soap</artifactId>
      <version>2.3</version>
    </dependency>
    <dependency>
      <groupId>javax.xml</groupId>
      <artifactId>saaj-api</artifactId>
      <version>1.1</version>
    </dependency>
    <dependency>
      <groupId>commons-discovery</groupId>
      <artifactId>commons-discovery</artifactId>
      <version>0.2</version>
    </dependency>
    <dependency>
      <groupId>javax.xml</groupId>
      <artifactId>jaxrpc-api</artifactId>
      <version>1.1</version>
    </dependency>
    <dependency>
      <groupId>jtidy</groupId>
      <artifactId>jtidy</artifactId>
      <version>4aug2000r7-dev</version>
    </dependency>

  </dependencies>

	<profiles>
	  <profile>
	    <id>wsrp2</id>
	    <activation>
	      <activeByDefault>true</activeByDefault>
	    </activation>
	    <properties>
	      <src.gen.dir>${basedir}/target/generated</src.gen.dir>
	    </properties>
	  </profile>
  </profiles>

  <build>

    <resources>
      <resource>
        <directory>target/generated</directory>
        <includes>
          <include>**/*.wsdd</include>
        </includes>
      </resource>
      <resource>
        <directory>src/main/resources</directory>
        <includes>
          <include>**/*.xml</include>
        </includes>
      </resource>
    </resources>

    <plugins>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-antrun-plugin</artifactId>
        <version>1.2-SNAPSHOT</version>
        <executions>
				  <execution>
				  	<id>0</id>
				    <phase>generate-sources</phase>
				    <configuration>
				      <tasks>
					      <mkdir dir="${src.gen.dir}" />
					      <java fork="yes" dir="wsdl" classname="org.apache.axis.wsdl.WSDL2Java">
					        <sysproperty key="proxySet" value="" />
					        <sysproperty key="proxyHost" value="localhost" />
					        <sysproperty key="proxyPort" value="80" />
					        <arg line="-v -t -O -1 -a --server-side --deployScope 'Application' -W -o ${src.gen.dir} wsrp_service.wsdl" />
					         <classpath refid="maven.dependency.classpath" />
					      </java>
					      <delete file="${src.gen.dir}/org/exoplatform/services/wsrp2/bind/WSRP_v2_ServiceDescription_Binding_SOAPImpl.java" />
					      <delete file="${src.gen.dir}/org/exoplatform/services/wsrp2/bind/WSRP_v2_Registration_Binding_SOAPImpl.java" />
					      <delete file="${src.gen.dir}/org/exoplatform/services/wsrp2/bind/WSRP_v2_Markup_Binding_SOAPImpl.java" />
					      <delete file="${src.gen.dir}/org/exoplatform/services/wsrp2/bind/WSRP_v2_PortletManagement_Binding_SOAPImpl.java" />
				      </tasks>
              <sourceRoot>${src.gen.dir}</sourceRoot>
				    </configuration>
			      <goals>
			        <goal>run</goal>
			      </goals>
				  </execution>
          <execution>
            <id>1</id>
            <phase>compile</phase>
            <configuration>
              <tasks>
                <taskdef name="hibernatedoclet"
                  classname="xdoclet.modules.hibernate.HibernateDocletTask"
                  classpathref="maven.compile.classpath"/>
                <hibernatedoclet destdir="${basedir}/target/classes"
                  excludedtags="@version,@author,@todo" mergedir="target/classes"
                  force="true" verbose="false">
                  <fileset dir="${basedir}/src/main/java">
                    <include name="**/*.java"/>
                  </fileset>
                  <hibernate version="3.0"/>
                </hibernatedoclet>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        </executions>
      </plugin>

      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-compiler-plugin</artifactId>
        <configuration>
          <source>1.5</source>
          <target>1.5</target>
        </configuration>
      </plugin>

    </plugins>

  </build>

	<reporting>
	  <plugins>
	    <plugin>
	      <groupId>org.apache.maven.plugins</groupId>
	      <artifactId>maven-checkstyle-plugin</artifactId>
	      <configuration>
	        <configLocation>${exo.projects.directory.src}/tools/trunk/config/exo-checkstyle-checker.xml</configLocation>
	        <suppressionsLocation>${exo.projects.directory.src}/tools/trunk/config/exo-checkstyle-suppressions.xml</suppressionsLocation>
	      </configuration>
	    </plugin>
	  </plugins>
	</reporting>

</project>
