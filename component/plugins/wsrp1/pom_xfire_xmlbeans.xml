<project>
   <parent>
    <groupId>org.exoplatform.portletcontainer</groupId>
    <artifactId>config</artifactId>
    <version>2.0</version>
  </parent>
  <modelVersion>4.0.0</modelVersion>
  <artifactId>exo.pc.component.plugins.wsrp1</artifactId>
  <packaging>jar</packaging>
  <name>eXo Portlet Container 2 plugins.wsrp1</name>
  <url>http://www.exoplatform.org</url>
  <description>eXo Portlet Container 2 wsrp1 plugin</description>

  <repositories>
    <repository>
      <id>codehaus</id>
      <name>Codehaus maven repository</name>
      <url>http://dist.codehaus.org/</url>
      <layout>legacy</layout>
    </repository>
    <repository>
      <id>apache-snapshots</id>
      <name>Snapshot repository</name>
      <url>http://people.apache.org/maven-snapshot-repository/</url>
    </repository>
  </repositories>
  <pluginRepositories>
    <pluginRepository>
      <id>snapshot</id>
      <name>Snapshot repository</name>
      <url>http://snapshots.maven.codehaus.org/maven2/</url>
    </pluginRepository>
  </pluginRepositories>

  <dependencies>

    <dependency>
      <groupId>org.exoplatform.kernel</groupId>
      <artifactId>exo.kernel.commons</artifactId>
      <version>${exo.platform.version}</version>
      <scope>compile</scope>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.kernel</groupId>
      <artifactId>exo.kernel.container</artifactId>
      <version>${exo.platform.version}</version>
      <scope>compile</scope>
    </dependency>
    
    <dependency>
      <groupId>org.exoplatform.kernel</groupId>
      <artifactId>exo.kernel.component.cache</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.xml-processing</artifactId>
      <version>${exo.platform.version}</version>
      <scope>compile</scope>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.organization.api</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.common</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.database</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.resources.api</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.core</groupId>
      <artifactId>exo.core.component.organization.jdbc</artifactId>
      <version>${exo.platform.version}</version>
    </dependency>

    <dependency>
       <groupId>org.exoplatform.portletcontainer</groupId>
       <artifactId>exo.pc.component.core</artifactId>
       <version>${exo.portlet-container.version}</version>
    </dependency>

    <dependency>
      <groupId>org.exoplatform.portletcontainer</groupId>
      <artifactId>exo.pc.component.plugins.pc</artifactId>
      <version>${exo.portlet-container.version}</version>
    </dependency>

    <!-- ************************ soap ************************ -->

    <dependency>
      <groupId>org.codehaus.mojo</groupId>
      <artifactId>xfire-maven-plugin</artifactId>
      <version>1.0-SNAPSHOT</version>
    </dependency>
    
    <dependency>
      <groupId>wsdl4j</groupId>
      <artifactId>wsdl4j</artifactId>
      <version>1.4</version>
    </dependency>
    
    <dependency>
      <groupId>soap</groupId>
      <artifactId>soap</artifactId>
      <version>2.3</version>
    </dependency>
    
    <dependency>
      <groupId>javax.xml</groupId>
      <artifactId>saaj-api</artifactId>
      <version>1.1</version>
    </dependency>
    
    <dependency>
      <groupId>commons-discovery</groupId>
      <artifactId>commons-discovery</artifactId>
      <version>0.2</version>
    </dependency>

    <dependency>
      <groupId>javax.xml</groupId>
      <artifactId>jaxrpc-api</artifactId>
      <version>1.1</version>
    </dependency>

    <dependency>
      <groupId>jtidy</groupId>
      <artifactId>jtidy</artifactId>
      <version>4aug2000r7-dev</version>
    </dependency>
    

  </dependencies>

	<profiles>
	  <profile>
	    <id>wsrp1</id>
	    <activation>
	      <activeByDefault>true</activeByDefault>
	    </activation>
	    <properties>
	      <src.gen.dir>${basedir}/target/generated</src.gen.dir>
	    </properties>
	  </profile>
	</profiles>

  <properties>
    <war.dir>${basedir}/war_template</war.dir>
  </properties>


  <build>
  
    <resources>
      <resource>
        <directory>target/generated</directory>
        <includes>
          <include>**/*.wsdd</include>
        </includes>
      </resource>
    </resources>

    <plugins>
    
      <plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>xmlbeans-maven-plugin</artifactId>
        <version>2.0</version>
        <executions>
          <execution>
            <phase>generate-sources</phase>
            <goals>
              <goal>xmlbeans</goal>
            </goals>
          </execution>
        </executions>
        <configuration>
          <verbose>true</verbose>
          <schemaDirectory>wsdl</schemaDirectory>
          <sourceGenerationDirectory>${src.gen.dir}</sourceGenerationDirectory>
        </configuration>
        <dependencies>
          <dependency>
            <groupId>stax</groupId>
            <artifactId>stax</artifactId>
            <version>1.1.2-dev</version>
            <exclusions>
              <exclusion>
                <groupId>xmlbeans</groupId>
                <artifactId>xmlbeans-jsr173-api</artifactId>
              </exclusion>
            </exclusions>
          </dependency>
        </dependencies>
      </plugin>
    
      <!-- plugin>
        <groupId>org.codehaus.mojo</groupId>
        <artifactId>xfire-maven-plugin</artifactId>
        <executions>
           <execution>
              <goals>
                 <goal>wsgen</goal>
              </goals>
           </execution>
        </executions>
        <configuration>
          <package>org.exoplatform.services.wsrp.wsdl</package>
          <profile>org.codehaus.xfire.gen.jsr181.Jsr181Profile</profile>
          <binding>xmlbeans</binding>
          <externalBindings>${basedir}/wsdl/wsrp-bindings.xjb</externalBindings>
          <outputDirectory>${src.gen.dir}</outputDirectory>
          <wsdls>
            <wsdl>${basedir}/wsdl/wsrp_service.wsdl</wsdl>
          </wsdls>
        </configuration>
      </plugin -->
    
      <plugin>
        <artifactId>maven-antrun-plugin</artifactId>
        <executions>
        
          <execution>
				    <id>0</id>
            <phase>generate-sources</phase>
            <configuration>
              <java classpathref="maven.compile.classpath" dir="${basedir}">
                <arg line="${basedir}/src/main/binding.xml"/>
              </java>
              <tasks>
                <taskdef name="wsgen" classname="org.codehaus.xfire.gen.WsGenTask"  
                	classpathref="maven.compile.classpath"/>
                <wsgen outputDirectory="${src.gen.dir}"
                  wsdl="${basedir}/wsdl/wsrp_service.wsdl" package="org.exoplatform.services.wsrp.wsdl" overwrite="true"/>
              </tasks>
              <sourceRoot>${src.gen.dir}</sourceRoot>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        
          <execution>
            <id>1</id>
            <phase>compile</phase>
            <configuration>
              <tasks>
                <taskdef name="hibernatedoclet"
                  classname="xdoclet.modules.hibernate.HibernateDocletTask"
                  classpathref="maven.compile.classpath"/>
                <hibernatedoclet destdir="${basedir}/target/classes"
                  excludedtags="@version,@author,@todo" mergedir="target/classes"
                  force="true" verbose="false">
                  <fileset dir="${basedir}/src/main/java">
                    <include name="**/*.java"/>
                  </fileset>
                  <hibernate version="3.0"/>
                </hibernatedoclet>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
          <execution>
            <id>2</id>
            <phase>generate-test-sources</phase>
            <configuration>
              <tasks>
                <mkdir dir="${basedir}/target/test-classes/"/>
                <copy todir="${basedir}/target/test-classes/">
                  <fileset dir="${basedir}/war_template/src">
                    <include name="**/*.properties"/>
                    <include name="**/*.xml"/>
                  </fileset>
                </copy>
                <javac fork="true" srcdir="${basedir}/war_template/src" destdir="${basedir}/target/test-classes/"
                           debug="${maven.compile.debug}"
                           deprecation="${maven.compile.deprecation}"
                           optimize="${maven.compile.optimize}">
                  <classpath>
                    <path refid="maven.dependency.classpath"/>
                    <pathelement path="${maven.build.dest}"/>
                  </classpath>
                </javac>
              </tasks>
            </configuration>
            <goals>
              <goal>run</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
      
      <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-surefire-plugin</artifactId>
        <configuration>
          <systemProperties>
            <property>
              <name>testPath</name>
              <value>${basedir}</value>
            </property>
            <property>
              <name>mock.portal.dir</name>
              <value>${war.dir}</value>
            </property>
            <property>
              <name>maven.exoplatform.dir</name>
              <value>${war.dir}</value>
            </property>
          </systemProperties>
          <includes>
            <include>**/Test*.java</include>
          </includes>
          <skip>true</skip>
        </configuration>
      </plugin>
      
	    <plugin>
	      <groupId>org.apache.maven.plugins</groupId>
	      <artifactId>maven-compiler-plugin</artifactId>
	      <configuration>
	        <source>1.5</source>
	        <target>1.5</target>
	      </configuration>
	    </plugin>
	    
    </plugins>
    
  </build>
  
</project>